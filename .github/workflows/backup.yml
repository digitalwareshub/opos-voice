# Automated backup workflow
name: Repository Backup

on:
  push:
    branches: [ main ]
  schedule:
    # Run backup every day at 2 AM UTC
    - cron: '0 2 * * *'

jobs:
  backup:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0  # Full history
        
    - name: Create backup archive
      run: |
        tar -czf "opos-voice-backup-$(date +%Y%m%d-%H%M%S).tar.gz" \
          --exclude='.git' \
          --exclude='node_modules' \
          --exclude='.next' \
          .
        
    - name: Upload backup artifact
      uses: actions/upload-artifact@v4
      with:
        name: repository-backup-${{ github.sha }}
        path: "*.tar.gz"
        retention-days: 90
        
  mirror-backup:
    runs-on: ubuntu-latest
    if: github.event_name == 'push'
    steps:
    - name: Mirror to secondary location
      run: |
        echo "Set up mirror repository backup here"
        echo "Consider using services like GitLab, Bitbucket, or Codeberg"
